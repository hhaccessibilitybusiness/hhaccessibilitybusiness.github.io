<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <!-- Meta, title, CSS, favicons, etc. -->
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>iMIS</title>

  <!-- Bootstrap core CSS -->

  <link href="css/bootstrap.min.css" rel="stylesheet">

  <link href="fonts/css/font-awesome.min.css" rel="stylesheet">
  <link href="css/animate.min.css" rel="stylesheet">

  <!-- Custom styling plus plugins -->
  <link href="css/custom.css" rel="stylesheet">
  <link href="css/icheck/flat/green.css" rel="stylesheet">


  <script src="js/jquery.min.js"></script>

  <!--[if lt IE 9]>
  <script src="../assets/js/ie8-responsive-file-warning.js"></script>
  <![endif]-->

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->

<script src="js/sweetalert.min.js"></script> 
 

<link rel="stylesheet" type="text/css" href="css/sweetalert.css">


</head>


<body class="nav-md" onload="companylisting(); workexperience()">

  <div class="container body">


    <div class="main_container">

      <div class="col-md-3 left_col">
        <div class="left_col scroll-view">

          <div class="navbar nav_title" style="border: 0;">
            <a href="index.html" class="site_title"><i class="fa fa-university"></i> <span>iMIS</span></a>
          </div>
          <div class="clearfix"></div>


          <!-- menu prile quick info -->
          <div class="profile">
            <div class="profile_pic">
              <img id="photo2" src="images/img.jpg" alt="..." class="img-circle profile_img">
            </div>
            <div class="profile_info">
              <span>Welcome,</span>
              <h2 id="username"></h2>
            </div>
          </div>
          <!-- /menu prile quick info -->

          <br />

          <!-- sidebar menu -->
          <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">

            <div class="menu_section">
              <!-- <h3>Student</h3> -->
              <br /><br /><br />
              <ul class="nav side-menu">
                <li><a><i class="fa fa-home"></i> Home <span class="fa fa-chevron-down"></span></a>
                  <ul class="nav child_menu" style="display: none">
                    <li><a href="profile.html">Dashboard</a>
                    </li>

                  </ul>
                </li>
                <li><a><i class="fa fa-edit"></i> Profile <span class="fa fa-chevron-down"></span></a>
                  <ul class="nav child_menu" style="display: none">
                    <li><a href="viewpersonal.html">Personal</a>
                    </li>
                    <li><a href="skills.html">Skills</a>
                    </li>
                    <li><a href="education.html">Education</a>
                    </li>
                    <li><a href="workexperience.html">Work Experience</a>
                    </li>
                    <li><a href="internship.html">Internship</a>
                    </li>
                  </ul>
                </li>
                <li><a><i class="fa fa-desktop"></i> Jobs <span class="fa fa-chevron-down"></span></a>
                  <ul class="nav child_menu" style="display: none">
                    <li><a href="viewalljob.html">Job List</a>
                    </li>
                    <li><a href="viewlikedjob.html">Liked Jobs</a>
                    </li>
                    <li><a href="viewassignedjob.html">Assigned Jobs</a>
                    </li>
                  </ul>
                </li>


              </ul>
            </div>

          </div>
          <!-- /sidebar menu -->


        </div>
      </div>

      <!-- top navigation -->
      <div class="top_nav">

        <div class="nav_menu">
          <nav class="" role="navigation">
            <div class="nav toggle">
              <a id="menu_toggle"><i class="fa fa-bars"></i></a>
            </div>

            <ul class="nav navbar-nav navbar-right">
              <li class="">
                <a href="javascript:;" class="user-profile dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                  <img id="photo1" src="images/img.jpg" alt=""><label id="username1"></label>
                  <span class=" fa fa-angle-down"></span>
                </a>
                <ul class="dropdown-menu dropdown-usermenu animated fadeInDown pull-right">
                  <li><a href="javascript:;">  Profile</a>
                  </li>

                  <li><a href="login.html"><i class="fa fa-sign-out pull-right"></i> Log Out</a>
                  </li>
                </ul>
              </li>

            </ul>
          </nav>
        </div>

      </div>
      <!-- /top navigation -->


      <!-- Top TABS nav content -->


      <!-- ENDsss Top TABS nav content -->




      <!-- page content -->

      <div class="right_col" role="main">

        <div class="row">
          <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="dashboard_graph">

              <!-- <div class="row x_title">
              <div class="col-md-6">
              <h3>Internship <small>information</small></h3>
            </div>
            <div class="col-md-6">
          </div>
        </div> -->

        <div class="col-md-12 col-sm-12 col-xs-12">
          <div class="x_panel">
            <div class="x_title">
              <h2><i class="fa fa-bars"></i> Work experience </h2>

              <div class="clearfix"></div>
            </div>
            <div class="x_content">


              <div class="" role="tabpanel" data-example-id="togglable-tabs">
                <ul id="myTab" class="nav nav-tabs bar_tabs" role="tablist">
                  <li role="presentation" class="active"><a href="#tab_content1" id="view-tab" role="tab" data-toggle="tab" aria-expanded="true">View</a>
                  </li>
                  <li role="presentation" class=""><a href="#tab_content2" role="tab" id="add-tab" data-toggle="tab" aria-expanded="false">Add</a>
                  </li>
                </ul>

                <div id="myTabContent" class="tab-content">
                  <div role="tabpanel" class="tab-pane fade active in" id="tab_content1" aria-labelledby="view-tab">


                    <div class="col-md-12 col-sm-12 col-xs-12">
                      <div class="x_panel">

                        <div class="x_content">

                          <form class="form-horizontal form-label-left" novalidate>


                            <span class="section">View</span>

                            <table class="table table-striped projects" id="viewalljob">
                    <thead>
                      <tr>
                        <th style="width: 1%">#</th>
                        <th>Company</th>
                        <th>Location</th>
                        <th>startdate</th>
                        <th>enddate</th>
                        <th>Position</th>
                        <th style="width: 10%">#Edit</th>
                      </tr>
                    </thead>
                    <tbody>
                      <!-- <tr>
                        <td>#</td>
                        <td>
                          Pesamakini Backend UI
                          <br />
                          <small>Created 01.01.2015</small>
                        </td>
                        <td>

                            <li>
                              <img src="images/user.png" class="avatar">
                            </li>


                        </td>
                        <td>
                          Google
                        </td>
                        <td>
                          9-5
                        </td>
                        <td>
                          <a href="#" class="btn btn-primary btn-xs"><i class="fa fa-folder"></i> View </a>
                          <a href="#" class="btn btn-success btn-xs"><i class="fa fa-thumbs-up"></i> Like </a>

                        </td>
                      </tr> -->

                    </tbody>
                  </table>



                          <!--   <div class="ln_solid"></div>
                            <div class="form-group">
                              <div class="col-md-6 col-md-offset-3">
                                <button type="submit" class="btn btn-primary">Cancel</button>
                                <button id="send" type="submit" class="btn btn-success" onclick="workadd()">Update</button>
                              </div>
                            </div> -->
                          </form>

                        </div>
                      </div>
                    </div>


                  </div>
                  <div role="tabpanel" class="tab-pane fade" id="tab_content2" aria-labelledby="add-tab">

                    <div class="col-md-12 col-sm-12 col-xs-12">
                      <div class="x_panel">

                        <div class="x_content">

                          <form class="form-horizontal form-label-left" novalidate>


                            <span class="section">Add</span>

                            <div class="form-group">
                              <label class="control-label col-md-3 col-sm-3 col-xs-12">Choose Company<span class="required">*</span></label>
                              <div class="col-md-6 col-sm-6 col-xs-12">
                                <select class="form-control" id="companyname" onchange="existingcompany(this)">
                                  <option value=""></option>
                                </select>
                              </div>
                            </div>


                            <div class="item form-group">
                              <label class="control-label col-md-3 col-sm-3 col-xs-12" for="location">Country<span class="required">*</span>
                              </label>
                              <div class="col-md-6 col-sm-6 col-xs-12">
                                <input id="location" class="form-control col-md-7 col-xs-12" name="location" required="required" type="text">
                              </div>
                            </div>

                            <div class="item form-group">
                              <label class="control-label col-md-3 col-sm-3 col-xs-12" for="startdate">Start Date of working:<span class="required">*</span>
                              </label>
                              <div class="col-md-6 col-sm-6 col-xs-12">
                                <input id="startdate" class="form-control col-md-7 col-xs-12" name="startdate"  type="date">
                              </div>
                            </div>


                            <div class="item form-group">
                              <label class="control-label col-md-3 col-sm-3 col-xs-12" for="enddate">End Date of working:<span class="required">*</span>
                              </label>
                              <div class="col-md-6 col-sm-6 col-xs-12">
                                <input id="enddate" class="form-control col-md-7 col-xs-12" name="enddate" required="required" type="date">
                              </div>
                            </div>


                            <div class="item form-group">
                              <label class="control-label col-md-3 col-sm-3 col-xs-6" for="position">Position<span class="required">*</span>
                              </label>
                              <div class="col-md-6 col-sm-6 col-xs-12">
                                <input id="position" class="form-control col-md-7 col-xs-12" name="position" required="required" type="text">
                              </div>
                            </div>


                            <div class="ln_solid"></div>
                            <div class="form-group">
                              <div class="col-md-6 col-md-offset-3">
                                <!-- <button type="submit" class="btn btn-primary">Cancel</button> -->
                                <button id="send" type="submit" class="btn btn-success" onclick="workadd()">Submit</button>
                              </div>
                            </div>
                          </form>

                        </div>
                      </div>
                    </div>





                  </div>

                </div>
              </div>

            </div>
          </div>
        </div>



      </div>
    </div>

    <!-- <div class="clearfix"></div> -->

    <!-- <div class="row"> -->

    <!-- </div> -->
  </div>
</div>


<div class="clearfix"></div>
</div>
</div>

</div>

</div>
</div>

<!-- footer content -->
<!-- <div class="main_container"> -->
<footer>
  <div class="copyright-info">
    <p class="pull-right">©2016 All Rights Reserved. Privacy and Terms
    </p>
  </div>
  <div class="clearfix"></div>
</footer>

<!-- /footer content -->

</div>
<!-- /page content -->
</div>

</div>



<script src="js/bootstrap.min.js"></script>

<!-- bootstrap progress js -->
<script src="js/progressbar/bootstrap-progressbar.min.js"></script>
<script src="js/nicescroll/jquery.nicescroll.min.js"></script>
<!-- icheck -->
<script src="js/icheck/icheck.min.js"></script>

<script src="js/custom.js"></script>
<!-- dropzone -->
<script src="js/dropzone/dropzone.js"></script>
<!-- pace -->
<script src="js/pace/pace.min.js"></script>




<!-- ADDed JS -->



<!-- pace -->
<!-- <script src="js/pace/pace.min.js"></script> -->
<!-- <script src="js/custom.js"></script> -->
<!-- form validation -->
<script src="js/validator/validator.js"></script>
<script>
// initialize the validator function
validator.message['date'] = 'not a real date';

// validate a field on "blur" event, a 'select' on 'change' event & a '.reuired' classed multifield on 'keyup':
$('form')
.on('blur', 'input[required], input.optional, select.required', validator.checkField)
.on('change', 'select.required', validator.checkField)
.on('keypress', 'input[required][pattern]', validator.keypress);

$('.multi.required')
.on('keyup blur', 'input', function() {
  validator.checkField.apply($(this).siblings().last()[0]);
});

// bind the validation to the form submit event
//$('#send').click('submit');//.prop('disabled', true);

$('form').submit(function(e) {
  e.preventDefault();
  var submit = true;
  // evaluate the form using generic validaing
  if (!validator.checkAll($(this))) {
    submit = false;
  }

  if (submit)
  this.submit();
  return false;
});

/* FOR DEMO ONLY */
$('#vfields').change(function() {
  $('form').toggleClass('mode2');
}).prop('checked', false);

$('#alerts').change(function() {
  validator.defaults.alerts = (this.checked) ? false : true;
  if (this.checked)
  $('form .alert').remove();
}).prop('checked', false);
</script>

<!-- End of ADDed JS -->



<script src="js/util.js"></script>
<script type="text/javascript">
function workadd(){
  // alert($('#username').val());
  $.post(HOST + "/addworkexperience",
  {
    username: sessionStorage.username,
    location: $('#location').val(),
    startdate: $('#startdate').val(),
    enddate: $('#enddate').val(),
    position: $('#position').val(),
    companyid: $('#companyname option:selected').val()
  },
  function(data, status){
    if(status === "success"){
          swal("Congratulations!", "Workexperience added!", "success")
          setTimeout(function(){window.location.replace("workexperience.html");},2000);
         // window.location.replace("internship.html");
        }

        else{
            swal("Oh No!", "Workexperience not added", "error")
            
        }

  });

}
$("#send").click(function(event)
{
  event.preventDefault(); // cancel default behavior

  //... rest of remove last logic
}); 

</script>


<script type="text/javascript">
function companylisting(){

  $.post(HOST + "/viewallcompany",
  {

    search: "all",
    city: "all",
    country: "all"

  },
  function(data, status){
    if(status === "success"){
      for(i=0; i< data.length; i++){
        var newOption = $('<option>');
        newOption.attr('value', data[i].id).text(data[i].companyname);
        $('#companyname').append(newOption);
        
      }
    }

    else{
      alert("no");
      new PNotify({
        title: 'Oh No!',
        text: 'Data not added',
        type: 'error'
      });
    }

  });


}

</script>


<script type="text/javascript">
var selectedValue = "none";
// GetSelectedTextValue(companyname);
function existingcompany(companyname) {
  var selectedText = companyname.options[companyname.selectedIndex].innerHTML;
  selectedValue = companyname.value;
}

function chosencompany() {
  if (sessionStorage.companyname == data[i].id) {
    // alert(semesterregistered);
    // alert(data[i].id);
    $("select option:contains(" + data[i].id + ")").prop("selected", true);
  }
  var selectedText = companyname.options[companyname.selectedIndex].innerHTML;
  selectedValue = companyname.value;
}

</script>

<script type="text/javascript">
document.getElementById("username").innerHTML = sessionStorage.username;
document.getElementById("username1").innerHTML = sessionStorage.username;
</script>

<!-- PNotify -->
<script type="text/javascript" src="js/notify/pnotify.core.js"></script>
<script type="text/javascript" src="js/notify/pnotify.buttons.js"></script>
<script type="text/javascript" src="js/notify/pnotify.nonblock.js"></script>



<!-- <script src="js/util.js"></script> -->


<script type="text/javascript">
var total = 0;
function workexperience(){
  $.post(HOST + "/viewstudentworkexperience",
    {

        username: sessionStorage.username

    },
    function(data, status){
k=1;
for(i=0;i<data.length;i++){
sessionStorage.jobs = JSON.stringify(data);
$("#viewalljob").find('tbody')
    .append($('<tr>')

        .append($('<td>')
               .text(k++)
        )

        .append($('<td>')
               .text(data[i].companyname)
        )
        .append($('<td>')
               .text(data[i].location)
        )
        .append($('<td>')
               .text(dateFormat(data[i].startdate))
        )

        .append($('<td>')
               .text(dateFormat(data[i].enddate))
        )
        .append($('<td>')
               .text(data[i].position)
        )
        .append($('<td>')
                  .append($('<a>')
                    .attr('onclick', 'del(this)')
                    .attr('href', '#')
                    .attr('class', 'btn btn-danger btn-xs') 
                    .attr('id','like' + i)
                    .attr('myid',i)
                    .append($('<i>')
                        .attr('class', 'fa fa-folder') 
                    )  
                    .text('Delete')  
                )
               
        )  

  );
}
    });


}

function dateFormat(newdate){
  var monthNames = [
    "January", "February", "March",
    "April", "May", "June", "July",
    "August", "September", "October",
    "November", "December"
  ];

  var date = new Date(newdate);
  var day = date.getDate();
  var monthIndex = date.getMonth();
  var year = date.getFullYear();

  console.log(day, monthNames[monthIndex], year);
  return day + ' ' + monthNames[monthIndex] + ' ' + year;
}
</script>




<script type="text/javascript">
        $("#username").html(sessionStorage.firstname + " " + sessionStorage.lastname);
        $("#username1").html(sessionStorage.firstname + " " + sessionStorage.lastname);
        if(sessionStorage.photoid != undefined){
        $('#photo1').attr('src', sessionStorage.photoid);
        $('#photo2').attr('src', sessionStorage.photoid);

     }
</script>
<!-- <script src="js/util.js"></script> -->
<script type="text/javascript">
  function del(that){
      
      var job = JSON.parse(sessionStorage.jobs);
      console.log(job[that.getAttribute('myid')])
      //alert(job[that.getAttribute('myid')].jobid);
      swal({   title: "Are you sure?",   text: "This job will be removed from your workexperience list!",   type: "warning",   showCancelButton: true,   confirmButtonColor: "#DD6B55",   confirmButtonText: "Yes, delete it!",   closeOnConfirm: false }, 
        
        function(){  
          console.log("inside");
          console.log(job[that.getAttribute('myid')].superid);
          $.post(HOST + "/deletedatafromtable",
          {
              id: job[that.getAttribute('myid')].superid,
              table: "workexperience"         
          },
          function(data, status){
              // $("#gpa").html(data[0].gpa); 
              //$("#totalcompanies").html(data.length);
              if(status === "success"){
                swal("Deleted!", "Job has been deleted from your workexperience list.", "success");
                 setTimeout(function(){location.reload();},2000);  
              }
    
        });

          


       });

       

 }   
</script>

</body>

</html>
